package com.nuvolect.pentest.lucene;
//
//TODO create class description
//

import android.os.Environment;

import com.nuvolect.pentest.util.OmniHash;
import com.nuvolect.pentest.util.Util;
import com.nuvolect.pentest.webserver.connector.VolUtil;

import org.apache.commons.io.FileUtils;

import java.io.File;
import java.util.Collection;

import static com.nuvolect.pentest.webserver.MimeUtil.TEXT_FILE_EXTENSION;

public class FileUtil {

    /**
     * Get a Lucene cache folder.
     * @param relativeSearchPath
     * @return
     */
    public static File getLucineCacheDir(String relativeSearchPath) {

        String volId = VolUtil.sdcardVolumeId;
        String hashedSearchPath = volId+OmniHash.encode( relativeSearchPath);
        String lucenePath = Util.getAppPublicFolderPath() + "/.lucine/" + hashedSearchPath;
        return new File( lucenePath);
    }

    public static String getLucineCacheDirPath(String relativeSearchPath) {

        String volId = VolUtil.sdcardVolumeId;
        String hashedSearchPath = volId+OmniHash.encode( relativeSearchPath);
        String lucenePath = Util.getAppPublicFolderPath() + "/.lucine/" + hashedSearchPath;
        return lucenePath;
    }

    public static boolean folderExists(String relativePath) {

        File dir = new File( Environment.getExternalStorageDirectory()+relativePath);
        return dir != null && dir.exists() && dir.isDirectory();
    }

    public static Collection getFilePaths(String topDirRelativePath) {

        File topDir = new File( Environment.getExternalStorageDirectory()+topDirRelativePath);
        Collection<File> files = FileUtils.listFiles(topDir, TEXT_FILE_EXTENSION, true);

        return files;
    }
}
