<!DOCTYPE html>
<html ng-app="myApp" ng-controller="myController">
<head>
    <title>App: {{ appName }}</title>

    <script src="/js/angular.min.js"></script>
    <link href="/css/bootstrap.css" rel="stylesheet">
    <link href="/css/app.css" rel="stylesheet">
    <link href="/css/probe.css" rel="stylesheet">

</head>

<body>
<!-- Bootstrap core JavaScript -->
<script src="/js/jquery-3.1.1.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<div ng-include="'./navbar.htm'"></div>

<div class="container">


    <div align="center">
        <h2>App: {{ appName }}</h2>

        <table class="card">
            <tr>
                <td>
                    <strong>App Name</strong>
                </td>
                <td>
                    {{ appName }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Package Name</strong>
                </td>
            <td>
                {{ packageName }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Target SDK</strong>
                </td>
                <td>
                    {{ targetSdk }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>APK Size</strong>
                </td>
                <td>
                    {{ apkSize | number}}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Decompile DEX</strong>
                </td>
                <td>
                    <a href="/decompile.htm?packageName={{packageName}}&appName={{appName}}">
                        <span class="glyphicon glyphicon-cog" style="font-size:1.8em"></span>
                    </a>
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Version Code</strong>
                </td>
            <td>
                {{ versionCode }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Version Name</strong>
                </td>
            <td>
                {{ versionName }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Last Update Time</strong>
                </td>
            <td>
                {{ lastUpdateTime }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>First Update Time</strong>
                </td>
            <td>
                {{ firstUpdateTime }}
            </td>
            </tr>

            <tr>
                <td>
                    <strong>Read Contacts</strong>
                </td>
            <td>
                {{ readContacts | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Write Contacts</strong>
                </td>
            <td>
                {{ writeContacts | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Read External Storage</strong>
                </td>
            <td>
                {{ readExternalStorage | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Write External Storage</strong>
                </td>
            <td>
                {{ writeExternalStorage | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Network Access</strong>
                </td>
            <td>
                {{ networkAccess | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Receive Boot Completed</strong>
                </td>
            <td>
                {{ receiveBootCompleted | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Internet</strong>
                </td>
            <td>
                {{ internet | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Get Accounts</strong>
                </td>
            <td>
                {{ getAccounts | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Camera</strong>
                </td>
            <td>
                {{ camera | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Record Audio</strong>
                </td>
            <td>
                {{ recordAudio | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Access Coarse Location</strong>
                </td>
            <td>
                {{ accessCoarseLocation | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Access Fine Location</strong>
                </td>
            <td>
                {{ accessFineLocation | showRequested }}
            </td>
            </tr>

            <tr>
                <td>
                    <strong>Read Calendar</strong>
                </td>
            <td>
                {{ readCalendar | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Write Calendar</strong>
                </td>
            <td>
                {{ writeCalendar | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Read Phone State</strong>
                </td>
            <td>
                {{ readPhoneState | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Call Phone</strong>
                </td>
            <td>
                {{ callPhone | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Read Call Log</strong>
                </td>
            <td>
                {{ readCallLog | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Write Call Log</strong>
                </td>
            <td>
                {{ writeCallLog | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Add Voicemail</strong>
                </td>
            <td>
                {{ addVoicemail | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Use SIP</strong>
                </td>
            <td>
                {{ useSip | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Process Outgoing Calls</strong>
                </td>
            <td>
                {{ processOutgoingCalls | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Send SMS</strong>
                </td>
            <td>
                {{ sendSms | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Receive SMS</strong>
                </td>
            <td>
                {{ receiveSms | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Read SMS</strong>
                </td>
            <td>
                {{ readSms | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Receive WAP Push</strong>
                </td>
            <td>
                {{ receiveWapPush | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Receive MMS</strong>
                </td>
            <td>
                {{ receiveMms | showRequested }}
            </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag System</strong>
                </td>
                <td>
                    {{ flagSystem | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Debuggable</strong>
                </td>
                <td>
                    {{ flagDebuggable | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Has Code</strong>
                </td>
                <td>
                    {{ flagHasCode | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Persistent</strong>
                </td>
                <td>
                    {{ flagPersistent | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Factory Test</strong>
                </td>
                <td>
                    {{ flagFactoryTest | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Allow Task Reparenting</strong>
                </td>
                <td>
                    {{ flagAllowTaskReparenting | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Allow Clear User Data</strong>
                </td>
                <td>
                    {{ flagAllowClearUserData | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Updated System App</strong>
                </td>
                <td>
                    {{ flagUpdatedSystemApp | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Test Only</strong>
                </td>
                <td>
                    {{ flagTestOnly | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Supports Small Screens</strong>
                </td>
                <td>
                    {{ flagSupportsSmallScreens | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Supports Normal Screens</strong>
                </td>
                <td>
                    {{ flagSupportsNormalScreens | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Supports Large Screens</strong>
                </td>
                <td>
                    {{ flagSupportsLargeScreens | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Resizable For Screens</strong>
                </td>
                <td>
                    {{ flagResizableForScreens | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Supports Screen Densities</strong>
                </td>
                <td>
                    {{ flagSupportsScreenDensities | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag VM Safe Mode</strong>
                </td>
                <td>
                    {{ flagVmSafeMode | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Allow Backup</strong>
                </td>
                <td>
                    {{ flagAllowBackup | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Kill After Restore</strong>
                </td>
                <td>
                    {{ flagKillAfterRestore | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Restore Any Version</strong>
                </td>
                <td>
                    {{ flagRestoreAnyVersion | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag External Storage</strong>
                </td>
                <td>
                    {{ flagExternalStorage | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Supports XLarge Screens</strong>
                </td>
                <td>
                    {{ flagSupportsXLargeScreens | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Large Heap</strong>
                </td>
                <td>
                    {{ flagLargeHeap | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Stopped</strong>
                </td>
                <td>
                    {{ flagStopped | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Supports RTL</strong>
                </td>
                <td>
                    {{ flagSupportsRTL | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Installed</strong>
                </td>
                <td>
                    {{ flagInstalled | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Is Data Only</strong>
                </td>
                <td>
                    {{ flagIsDataOnly | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Is Game</strong>
                </td>
                <td>
                    {{ flagIsGame | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Full Backup Only</strong>
                </td>
                <td>
                    {{ flagFullBackupOnly | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Uses Cleartext Traffic</strong>
                </td>
                <td>
                    {{ flagUsesCleartextTraffic | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Extract Native Libs</strong>
                </td>
                <td>
                    {{ flagExtractNativeLibs | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Hardware Excelerated</strong>
                </td>
                <td>
                    {{ flagHardwareExcelerated | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Suspended</strong>
                </td>
                <td>
                    {{ flagSuspended | showFlag }}
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Flag Multiarch</strong>
                </td>
                <td>
                    {{ flagMultiarch | showFlag }}
                </td>
            </tr>
        </table>
    </div>


</div><!-- /card-container -->

<br>
<br>
<div ng-include="'footer.htm'"></div>

<script>

var app = angular.module('myApp', []);
app.controller('myController', function($scope, $http, $parse) {

    function getURLParameter(name) {
      return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search) || [null, ''])[1].replace(/\+/g, '%20')) || null;
    }

    var package = getURLParameter('package');
    $scope.package = package;

     $http.get("/device/app_detail/?package_name="+package)
       .then(function (response) {

        // Object is currently a string, convert it to JSON
        var app_detail = $.parseJSON( response.data.app_detail );
        
        $scope.accessCoarseLocation = app_detail.accessCoarseLocation;
        $scope.accessFineLocation = app_detail.accessFineLocation;
        $scope.addVoicemail = app_detail.addVoicemail;
        $scope.appName = app_detail.appName;
        $scope.callPhone = app_detail.callPhone;
        $scope.camera = app_detail.camera;
        $scope.firstUpdateTime = new Date(app_detail.firstUpdateTime).toUTCString();
        $scope.flags = app_detail.flags; 
        $scope.getAccounts = app_detail.getAccounts;
        $scope.internet = app_detail.internet;
        $scope.lastUpdateTime = new Date(app_detail.lastUpdateTime).toUTCString();
        $scope.makeModel = app_detail.makeModel;
        $scope.networkAccess = app_detail.networkAccess;
        $scope.packageName = app_detail.packageName;
        $scope.processOutgoingCalls = app_detail.processOutgoingCalls;
        $scope.readCalendar = app_detail.readCalendar;
        $scope.readCallLog = app_detail.readCallLog;
        $scope.readContacts = app_detail.readContacts;
        $scope.readExternalStorage = app_detail.readExternalStorage;
        $scope.readPhoneState = app_detail.readPhoneState;
        $scope.readSms = app_detail.readSms;
        $scope.receiveBootCompleted = app_detail.receiveBootCompleted;
        $scope.receiveMms = app_detail.receiveMms;
        $scope.receiveSms = app_detail.receiveSms;
        $scope.receiveWapPush = app_detail.receiveWapPush;
        $scope.recordAudio = app_detail.recordAudio;
        $scope.sendSms = app_detail.sendSms;
        $scope.targetSdk = app_detail.targetSdk;
        $scope.useSip = app_detail.useSip;
        $scope.versionCode = app_detail.versionCode;
        $scope.versionName = app_detail.versionName;
        $scope.writeCalendar = app_detail.writeCalendar;
        $scope.writeCallLog = app_detail.writeCallLog;
        $scope.writeContacts = app_detail.writeContacts;
        $scope.writeExternalStorage = app_detail.writeExternalStorage;
    
        $scope.flagAllowBackup = app_detail.flagAllowBackup;
        $scope.flagAllowClearUserData = app_detail.flagAllowClearUserData;
        $scope.flagAllowTaskReparenting = app_detail.flagAllowTaskReparenting;
        $scope.flagDebuggable = app_detail.flagDebuggable;
        $scope.flagExternalStorage = app_detail.flagExternalStorage;
        $scope.flagExtractNativeLibs = app_detail.flagExtractNativeLibs;
        $scope.flagFactoryTest = app_detail.flagFactoryTest;
        $scope.flagFullBackupOnly = app_detail.flagFullBackupOnly;
        $scope.flagHardwareExcelerated = app_detail.flagHardwareExcelerated;
        $scope.flagHasCode = app_detail.flagHasCode;
        $scope.flagInstalled = app_detail.flagInstalled;
        $scope.flagIsDataOnly = app_detail.flagIsDataOnly;
        $scope.flagIsGame = app_detail.flagIsGame;
        $scope.flagKillAfterRestore = app_detail.flagKillAfterRestore;
        $scope.flagLargeHeap = app_detail.flagLargeHeap;
        $scope.flagMultiarch  = app_detail.flagMultiarch;
        $scope.flagPersistent = app_detail.flagPersistent;
        $scope.flagResizableForScreens = app_detail.flagResizableForScreens;
        $scope.flagRestoreAnyVersion = app_detail.flagRestoreAnyVersion;
        $scope.flagStopped = app_detail.flagStopped;
        $scope.flagSupportsLargeScreens = app_detail.flagSupportsLargeScreens;
        $scope.flagSupportsNormalScreens = app_detail.flagSupportsNormalScreens;
        $scope.flagSupportsRTL = app_detail.flagSupportsRTL;
        $scope.flagSupportsScreenDensities = app_detail.flagSupportsScreenDensities;
        $scope.flagSupportsSmallScreens = app_detail.flagSupportsSmallScreens;
        $scope.flagSupportsXLargeScreens = app_detail.flagSupportsXLargeScreens;
        $scope.flagSuspended = app_detail.flagSuspended;
        $scope.flagSystem = app_detail.flagSystem;
        $scope.flagTestOnly = app_detail.flagTestOnly;
        $scope.flagUpdatedSystemApp = app_detail.flagUpdatedSystemApp;
        $scope.flagUsesCleartextTraffic = app_detail.flagUsesCleartextTraffic;
        $scope.flagVmSafeMode = app_detail.flagVmSafeMode;

        $scope.apkSize = app_detail.apkSize;
     });
});

app.filter('showRequested', function() {
 return function(x) {

    if( x == 1)
        return "Requested";
    if( x == 0)
        return "-";

    return "";
 };
});
app.filter('showFlag', function() {
 return function(x) {

    if( x == 1)
        return "Set";
    if( x == 0)
        return "-";

    return "";
 };
});

</script>
</body>
</html>